# 공통 변수
---
# Kubernetes 버전
kubernetes_version: "1.28.4-1.1"
kubernetes_cni_version: "1.28.0-1.1"

# 네트워크 (Calico 사용)
pod_network_cidr: "192.168.0.0/16"  # Calico 기본값
service_cidr: "10.96.0.0/12"

# Control Plane Endpoint (HA 확장 대비)
# 현재: 단일 마스터지만 향후 HA 확장을 위해 설정
# 실제 HA 구축 시 LB/NLB DNS로 변경
control_plane_endpoint: "{{ private_ip }}:6443"

# Docker
docker_version: "24.0"

# ArgoCD
argocd_version: "stable"
argocd_namespace: "argocd"

# AWS (ALB Controller용)
# ⚠️ vpc_id와 acm_certificate_arn은 ansible-playbook 실행 시 -e 옵션으로 전달 필요
# 또는 terraform output을 파일로 저장 후 읽기
aws_region: "ap-northeast-2"
cluster_name: "sesacthon"
vpc_id: "{{ vpc_id | default('') }}"  # rebuild script에서 전달
acm_certificate_arn: "{{ acm_certificate_arn | default('') }}"  # rebuild script에서 전달
domain_name: "growbin.app"

# RabbitMQ (Tier 3: Message Queue Middleware)
rabbitmq_namespace: "messaging"
rabbitmq_username: "admin"
rabbitmq_password: "{{ lookup('env', 'RABBITMQ_PASSWORD') | default('changeme', true) }}"
rabbitmq_persistence_size: "20Gi"  # 20GB × 3 nodes
rabbitmq_replicas: 3  # HA Cluster

# Redis (Tier 4: Persistence - Cache & State)
redis_namespace: "default"
redis_maxmemory: "2gb"
redis_databases: 16
# DB 0: Celery Result Backend
# DB 1: Image Hash Cache (AI 비용 70% 절감!)
# DB 2: Job Progress Tracking (0.5초 Polling)
# DB 3: Rate Limiting (DDoS 방지)
# DB 4: Token Blacklist (로그아웃, JWT 무효화)
# ❌ Session Store 없음 (JWT Stateless!)

# Monitoring
monitoring_namespace: "monitoring"
prometheus_retention: "7d"
grafana_admin_password: "{{ lookup('env', 'GRAFANA_PASSWORD') | default('admin123', true) }}"

# 기타
kubectl_user: "ubuntu"
kubectl_home: "/home/ubuntu"

# Cert-manager (Let's Encrypt)
letsencrypt_email: "admin@growbin.app"  # Let's Encrypt 인증서 이메일

