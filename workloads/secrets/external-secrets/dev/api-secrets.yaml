---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: auth-secret
  namespace: auth
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: AUTH_JWT_SECRET_KEY
      remoteRef:
        key: /sesacthon/dev/api/auth/jwt-secret
    - secretKey: AUTH_GOOGLE_CLIENT_ID
      remoteRef:
        key: /sesacthon/dev/api/auth/google-client-id
    - secretKey: AUTH_GOOGLE_CLIENT_SECRET
      remoteRef:
        key: /sesacthon/dev/api/auth/google-client-secret
    - secretKey: AUTH_KAKAO_CLIENT_ID
      remoteRef:
        key: /sesacthon/dev/api/auth/kakao-client-id
    - secretKey: AUTH_NAVER_CLIENT_ID
      remoteRef:
        key: /sesacthon/dev/api/auth/naver-client-id
    - secretKey: AUTH_NAVER_CLIENT_SECRET
      remoteRef:
        key: /sesacthon/dev/api/auth/naver-client-secret
    - secretKey: POSTGRES_PASSWORD
      remoteRef:
        key: /sesacthon/dev/data/postgres-password
  target:
    name: auth-secret
    creationPolicy: Owner
    template:
      data:
        AUTH_DATABASE_URL: "postgresql+asyncpg://sesacthon:{{ .POSTGRES_PASSWORD | urlquery }}@postgres-cluster.postgres.svc.cluster.local:5432/sesacthon?ssl=require"
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: character-secret
  namespace: character
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: API_KEY
      remoteRef:
        key: /sesacthon/dev/api/character/api-key
  target:
    name: character-secret
    creationPolicy: Owner
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: chat-secret
  namespace: chat
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: OPENAI_API_KEY
      remoteRef:
        key: /sesacthon/dev/api/chat/openai-api-key
  target:
    name: chat-secret
    creationPolicy: Owner
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: info-secret
  namespace: info
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: API_KEY
      remoteRef:
        key: /sesacthon/dev/api/info/api-key
  target:
    name: info-secret
    creationPolicy: Owner
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: location-secret
  namespace: location
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: API_KEY
      remoteRef:
        key: /sesacthon/dev/api/location/api-key
  target:
    name: location-secret
    creationPolicy: Owner
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: my-secret
  namespace: my
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: API_KEY
      remoteRef:
        key: /sesacthon/dev/api/my/api-key
  target:
    name: my-secret
    creationPolicy: Owner
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: scan-secret
  namespace: scan
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-ssm-store
  data:
    - secretKey: API_KEY
      remoteRef:
        key: /sesacthon/dev/api/scan/api-key
  target:
    name: scan-secret
    creationPolicy: Owner

